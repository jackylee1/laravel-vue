# 表设计

- wechats
    - member_id
    - open_id
    - name
    - avatar
    - gender
    - country 
    - province 
    - city

- addresses
    - member_id
    - address    
    
- members
    - name
    - mobile
    - identity
    - identity_files
    - identify_status
    - valid_date

- agents
    - member_id 代理人同时也是用户
    - parent_id 上级同是 agent
    - open_bank
    - bank_account

- products
    - name
    - price
    - commission_rate
    - status
    - cover
    - description
    - inventory
    - sale_count
    - category 体检/清洁/...

- product_posters 产品海报
    - product_id    
    - src    
    - x-axis    
    - y-axis    
    - width    

- product_items
    - product_id
    - related_type
    - related_id
    
-product_tag
    - product_id
    - tag_id
    
- tag
    - title
    - description

- physical_examinations
    - title
    - price
    - type
    - extra_no
    - protocol_name
    - protocol_url
    
- physical_examination_combos    
    - product_id
    - physical_examination_id
    - code
    
- shanzhen 这个是善诊的体检机构表，直接 shanzhen.sql 文件导入
    
- physical_examination_qualifications
    - member_id
    - order_id
    - status
    - combo_code
    - physical_examination_id
    - out_order_no
    - reason
    - title
    
- physical_examination_reservations
    - physical_examination_qualification_id
    - name
    - mobile
    - identity
    - date
    - org_id
    - org_name
    - org_address
    - deleted_at

- orders
    - title
    - product_id    
    - amount
    - commission
    - status
    - payment_id
    - member_id
    - agent_id

- order_items：从product_items继承
    - order_id
    - related_type 用来生成权益
    - related_id
    
- payments
    - order_id
    - type  支付方式:目前只有微信支付
    - amount
    - status
    - paid_at
    - transaction_no
    - extras    
    - inner_transaction_no
    
- accounts：代理人账户
    - agent_id
    - balance 根据账户流水实时更新。注意更新：where()->increment('balance', xxx)。提现成功，扣除相应金额
    - available 可提现金额。计划任务：账期（30）天之前的业绩。发起提现时，需要扣除对应金额。
    
- account_statements: 账户流水。
    - account_id
    - type     业绩入账/退单/团队业绩？/提现（提现审核并转账成功后写入一笔）
    - amount  10、-10  根据类型判断调整
    - order_id 提现/团队业绩结算时，为空 
    - status   待核算/已核算/无需核算 订单支付成功，写入一笔业绩"待核算"，账期到划入"已核算"
    - withdraw_id  提现
    - account_balance 记录某一时刻此比流水发生后的账户余额
    
- withdraws 
> - 发起提现，account.balance、account.available同时扣除相应金额，并且生成account_statement类型是提现的流水；
> - 提现成功，更新withdraw.status;
> - 提现驳回， account.balance、account.available同时`返还`相应金额，并且生成account_statement类型是提现(状态是失败)的流水；更新withdraws.status为失败

    - agent_id
    - amount
    - status    
    - bank_account 纯文本，记录用户的银行卡开户行和卡号
    - remark 备注
    - finished_at 打款时间

- banners 第一版可以先由前端写死
    - title
    - introduction
    - cover
    - link
    - status 是否展示
    - begin_at 在指定日期内展示
    - end_at
    
- 后台管理相关用户、权限等模块    
        
        
